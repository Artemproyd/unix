#!/usr/bin/env python3

import requests
import threading
import time
import random

def send_request(i):
    try:
        # –†–∞–∑–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –¥–ª—è —Ä–∞–∑–Ω–æ–≥–æ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
        texts = [
            f"–ü–µ—Ä–≤—ã–π —Ç–µ—Å—Ç {i} –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏",
            f"–í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Ç–µ–∫—Å—Ç–∞ –Ω–æ–º–µ—Ä {i} —Å –¥—Ä—É–≥–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º", 
            f"–¢—Ä–µ—Ç–∏–π —Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏ {i} —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –∏–Ω–æ–π –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ",
            f"–ß–µ—Ç–≤–µ—Ä—Ç—ã–π –≤–∏–¥ —Å–æ–æ–±—â–µ–Ω–∏—è {i} –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è",
            f"–ü—è—Ç—ã–π —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ {i} —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø–æ —Å–≤–æ–µ–π —Å—É—Ç–∏"
        ]
        text = random.choice(texts)
        
        r = requests.post("http://localhost:8080/analyze", json={"text": text})
        data = r.json()
        if data.get('success'):
            print(f"‚úÖ –ó–∞–¥–∞—á–∞ {i}: '{text[:20]}...' ‚Üí {data['processed_by']}")
        else:
            print(f"‚ùå –ó–∞–¥–∞—á–∞ {i}: –æ—à–∏–±–∫–∞ - {data.get('error')}")
    except Exception as e:
        print(f"‚ùå –ó–∞–¥–∞—á–∞ {i}: {e}")

print("üöÄ –ê–ì–†–ï–°–°–ò–í–ù–´–ô –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç...")

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º 50 –∑–∞–¥–∞—á –û–ß–ï–ù–¨ –±—ã—Å—Ç—Ä–æ
threads = []
for i in range(50):
    t = threading.Thread(target=send_request, args=(i,))
    threads.append(t)
    t.start()
    time.sleep(0.01)  # –û–ß–ï–ù–¨ –±—ã—Å—Ç—Ä–æ!

# –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–æ–≤
for t in threads:
    t.join()

print("‚úÖ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ!") 